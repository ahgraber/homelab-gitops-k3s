# deny secret outputs
prefix_rule(pattern = ["kubectl", "get", "secret", "-o"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secrets", "-o"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secret", "--output"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secrets", "--output"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secret", "-ojson"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secrets", "-ojson"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secret", "-oyaml"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secrets", "-oyaml"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secret", "-ojsonpath"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secrets", "-ojsonpath"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secret", "-ogo-template"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secrets", "-ogo-template"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secret", "--template"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secrets", "--template"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secret", "--template-file"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secrets", "--template-file"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "externalsecret", "-o"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "externalsecrets", "-o"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "clusterexternalsecret", "-o"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "clusterexternalsecrets", "-o"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secretstore", "-o"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "secretstores", "-o"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "clustersecretstore", "-o"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
prefix_rule(pattern = ["kubectl", "get", "clustersecretstores", "-o"], decision = "forbidden", justification = "Agents should not access secrets content. Use non-secret kubectl commands instead.")
# allow other information seeking
prefix_rule(pattern = ["kubectl", "get"], decision = "allow")
prefix_rule(pattern = ["kubectl", "describe"], decision = "allow")
prefix_rule(pattern = ["kubectl", "logs"], decision = "allow")
prefix_rule(pattern = ["kubectl", "top"], decision = "allow")
prefix_rule(pattern = ["kubectl", "events"], decision = "allow")
prefix_rule(pattern = ["kubectl", "api-resources"], decision = "allow")
prefix_rule(pattern = ["kubectl", "api-versions"], decision = "allow")
prefix_rule(pattern = ["kubectl", "cluster-info"], decision = "allow")
prefix_rule(pattern = ["kubectl", "version"], decision = "allow")
prefix_rule(pattern = ["kubectl", "explain"], decision = "allow")

prefix_rule(pattern = ["flux", "get"], decision = "allow")
prefix_rule(pattern = ["flux", "logs"], decision = "allow")
prefix_rule(pattern = ["flux", "check"], decision = "allow")
prefix_rule(pattern = ["flux", "tree"], decision = "allow")
prefix_rule(pattern = ["flux", "trace"], decision = "allow")
