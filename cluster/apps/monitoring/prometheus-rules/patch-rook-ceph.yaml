### https://raw.githubusercontent.com/rook/rook/v1.9.6/deploy/examples/monitoring/localrules.yaml
# ref: https://rook.github.io/docs/rook/v1.9/ceph-monitoring.html#customize-alerts
# CephNodeNetworkPacketDrops
- op: replace
  path: /spec/groups/6/rules/1
  value:
    alert: CephNodeNetworkPacketDrops
    expr: |
      (
        increase(node_network_receive_drop_total{device!="lo"}[1m]) +
        increase(node_network_transmit_drop_total{device!="lo"}[1m])
      ) / (
        increase(node_network_receive_packets_total{device!="lo"}[1m]) +
        increase(node_network_transmit_packets_total{device!="lo"}[1m])
      ) >= 0.005 or (
        increase(node_network_receive_drop_total{device!="lo"}[1m]) +
        increase(node_network_transmit_drop_total{device!="lo"}[1m])
      ) >= 75
    labels:
      severity: warning
      type: ceph_default
      oid: 1.3.6.1.4.1.50495.1.2.1.8.2
    annotations:
      summary: One or more Nics is seeing packet drops
      description: >
        Node {{ $labels.instance }} experiences packet drop > 0.01% or > 10 packets/s on interface {{ $labels.device }}.

# # CephNodeNetworkPacketErrors
- op: add
  path: /spec/groups/6/rules/2/for
  value: 1m
# CephNodeInconsistentMTU
- op: remove
  path: /spec/groups/6/rules/4
