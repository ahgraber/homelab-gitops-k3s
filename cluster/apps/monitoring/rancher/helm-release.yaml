---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: rancher
  namespace: cattle-system
spec:
  interval: 5m
  chart:
    spec:
      # renovate: registryUrl=https://releases.rancher.com/server-charts/stable
      chart: rancher
      version: 2.6.2
      sourceRef:
        kind: HelmRepository
        name: rancher-charts
        namespace: flux-system
  # targetNamespace: cattle-system
  values:
    # rancherImageTag: v2.5.9
    replicas: 3
    hostname: rancher.${SECRET_DOMAIN}
    ingress:
      enabled: false
      tls:
        source: rancher  # if `tls-rancher-ingress` cert has been created, otherwise delete
        secretName: tls-rancher-ingress
    tls: external  # if using ingress with tls/ssl termination
    tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
