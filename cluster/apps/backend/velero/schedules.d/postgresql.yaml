---
# Standard Kubernetes API Version declaration. Required.
apiVersion: velero.io/v1
kind: Schedule
metadata:
  name: postgresql-schedule
  namespace: velero
spec:
  # Schedule is a Cron expression defining when to run the Backup
  # Kubernetes uses UTC exclusively - adjust from local time!
  # Local is (UTC - 4) // UTC is (local + 4)
  schedule: 0 5 * * *
  template:
    # Array of namespaces to include in the scheduled backup. If unspecified, all namespaces are included.
    # Optional.
    includedNamespaces:
      - 'postgresql'
    # # Array of namespaces to exclude in the scheduled backup. If unspecified, all namespaces are included.
    # excludedNamespaces:
    #   - ''
    # Array of resources to include in the scheduled backup. If unspecified, all resources are included. Optional.
    includedResources:
      # - '*'
      - 'pvc'
      - 'pv'
    # # Array of resources to exclude from the scheduled backup.
    # excludedResources:
    #   - storageclasses.storage.k8s.io
    # Whether or not to include cluster-scoped resources. [true, false, and null/unset].
    includeClusterResources: null
    # # Individual objects must match this label selector to be included in the scheduled backup. Optional.
    # labelSelector:
    #   matchLabels:
    #     app: velero
    #     component: server
    # Whether or not to snapshot volumes.
    # This only applies to PersistentVolumes for Azure, GCE, and AWS.
    # Valid values are true, false, and null/unset.
    # If unset, Velero performs snapshots as long as a persistent volume provider is configured for Velero.
    snapshotVolumes: null
    # Where to store the tarball and logs.
    storageLocation: postgresql-storagelocation
    # The list of locations in which to store volume snapshots created for backups under this schedule.
    volumeSnapshotLocations:
      - postgresql-storagelocation
    # The amount of time before backups created on this schedule are eligible for garbage collection.
    ttl: 168h0m0s
