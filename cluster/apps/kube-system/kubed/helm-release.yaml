---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: kubed
  namespace: kube-system
spec:
  interval: 5m
  chart:
    spec:
      # renovate: registryUrl=https://charts.appscode.com/stable/
      chart: kubed
      version: v0.13.2
      sourceRef:
        kind: HelmRepository
        name: appscode-charts
        namespace: flux-system
      interval: 5m
  values:
    # Log level for operator
    logLevel: 3

    apiserver:
      # Port used by Kubed server
      securePort: "8443"
      # If true, uses kube-apiserver FQDN for AKS cluster to workaround https://github.com/Azure/AKS/issues/522 (default true)
      useKubeapiserverFqdnForAks: false
      healthcheck:
        # healthcheck configures the readiness and liveliness probes for the operator pod.
        enabled: false
      servingCerts:
        # If true, generates on install/upgrade the certs that allow the kube-apiserver (and potentially ServiceMonitor)
        # to authenticate operators pods. Otherwise specify certs in `apiserver.servingCerts.{caCrt, serverCrt, serverKey}`.
        generate: true
        # # CA certficate used by serving certificate of Kubed server.
        # caCrt: ""
        # # Serving certficate used by Kubed server.
        # serverCrt: ""
        # # Private key for the serving certificate used by Kubed server.
        # serverKey: ""

    # If true, sends usage analytics
    enableAnalytics: false

    # config:
    #   # Set cluster-name to something meaningful to you, say, prod, prod-us-east, qa, etc.
    #   # so that you can distinguish notifications sent by kubed
    #   clusterName: ""
    #   # If set, configmaps and secrets from only this namespace will be synced
    #   configSourceNamespace: ""
    #   # kubeconfig file content for configmap and secret syncer
    #   kubeconfigContent: ""
    # #  additionalOptions:
    # #    - --authentication-skip-lookup
