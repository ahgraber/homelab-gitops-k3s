---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: rancher
  namespace: kube-system
spec:
  interval: 5m
  chart:
    spec:
      # renovate: registryUrl=https://releases.rancher.com/server-charts/stable
      chart: rancher
      targetNamespace: cattle-system
      version: v2.5.9
      sourceRef:
        kind: HelmRepository
        name: rancher-charts
        namespace: flux-system
  values:
    rancherImageTag: v2.5.9
    hostname: rancher.${SECRET_DOMAIN}
    ingress.enabled: false
    # ingress.tls.source: secret  # if `tls-rancher-ingress` cert has been created, otherwise delete
    tls: ingress  # if using ingress with tls/ssl termination
    tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
        operator: Exists
    ### use custom ingressRoute.yaml instead
    # ingress:
    #   main:
    #     enabled: true
    #     annotations:
    #       kubernetes.io/ingress.class: "nginx"
    #     hosts:
    #     - host: "homer.${SECRET_DOMAIN}"
    #       paths:
    #       - path: /
    #         pathType: Prefix
    #     tls:
    #     - hosts:
    #       - "homer.${SECRET_DOMAIN}"
