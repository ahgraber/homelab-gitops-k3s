---
apiVersion: external-secrets.io/v1
kind: ClusterExternalSecret
# The ClusterExternalSecret creates an ExternalSecret in each namespace
# that does not have the label "clustersecret.external-secrets.io/disable" set to "true".
# The ExternalSecret will sync the secret data from the external secret store
# into an actual Kubernetes Secret in the namespace.
metadata:
  name: shared-example-onepassword-secret
spec:
  externalSecretName: shared-example-onepassword-secret
  namespaceSelector:
    matchLabels:
      kubernetes.io/metadata.name: default
  refreshTime: 1h
  externalSecretSpec:
    secretStoreRef:
      kind: ClusterSecretStore
      name: onepassword
    target:
      name: shared-example-onepassword-secret
    data:
      - secretKey: username
        remoteRef:
          key: shared.cluster-secrets
          property: username
      - secretKey: password
        remoteRef:
          key: shared.cluster-secrets
          property: password
